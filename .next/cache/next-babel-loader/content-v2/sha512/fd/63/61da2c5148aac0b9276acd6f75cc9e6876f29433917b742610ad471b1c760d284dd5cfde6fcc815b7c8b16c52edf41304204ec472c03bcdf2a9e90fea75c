{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"/opt/lampp/htdocs/wordpress/wp-content/themes/react-next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/opt/lampp/htdocs/wordpress/wp-content/themes/react-next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useContext, useEffect } from 'react';\nimport Billing from \"./Billing\";\nimport YourOrder from \"./YourOrder\";\nimport PaymentModes from \"./PaymentModes\";\nimport { AppContext } from \"../context/AppContext\";\nimport validateAndSanitizeCheckoutForm from '../../validator/checkout';\nimport { useMutation, useQuery } from '@apollo/client';\nimport { getFormattedCart, createCheckoutData } from \"../../functions\";\nimport OrderSuccess from \"./OrderSuccess\";\nimport GET_CART from \"../../queries/get-cart\";\nimport CHECKOUT_MUTATION from \"../../mutations/checkout\";\n\nvar CheckoutForm = function CheckoutForm() {\n  var initialState = {\n    firstName: '',\n    lastName: '',\n    company: '',\n    country: '',\n    address1: '',\n    address2: '',\n    city: '',\n    state: '',\n    postcode: '',\n    phone: '',\n    email: '',\n    createAccount: false,\n    orderNotes: '',\n    paymentMethod: '',\n    errors: null\n  }; // Use this for testing purposes, so you dont have to fill the checkout form over an over again.\n  // const initialState = {\n  // \tfirstName: 'Imran',\n  // \tlastName: 'Sayed',\n  // \taddress1: '109 Hills Road Valley',\n  // \taddress2: 'Station Road',\n  // \tcity: 'Pune',\n  // \tstate: 'Maharastra',\n  // \tcountry: 'ID',\n  // \tpostcode: '400298',\n  // \tphone: '9959338989',\n  // \temail: 'imran@gmail.com',\n  // \tcompany: 'Tech',\n  // \tcreateAccount: false,\n  // \torderNotes: '',\n  // \tpaymentMethod: 'cod',\n  // \terrors: null\n  // };\n\n  var _useContext = useContext(AppContext),\n      cart = _useContext[0],\n      setCart = _useContext[1];\n\n  var _useState = useState(initialState),\n      input = _useState[0],\n      setInput = _useState[1];\n\n  var _useState2 = useState(null),\n      orderData = _useState2[0],\n      setOrderData = _useState2[1];\n\n  var _useState3 = useState(null),\n      requestError = _useState3[0],\n      setRequestError = _useState3[1]; // Get Cart Data.\n\n\n  var _useQuery = useQuery(GET_CART, {\n    notifyOnNetworkStatusChange: true,\n    onCompleted: function onCompleted() {\n      // console.warn( 'completed GET_CART' );\n      // Update cart in the localStorage.\n      var updatedCart = getFormattedCart(data);\n      localStorage.setItem('woo-next-cart', JSON.stringify(updatedCart)); // Update cart data in React Context.\n\n      setCart(updatedCart);\n    }\n  }),\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      data = _useQuery.data,\n      refetch = _useQuery.refetch; // Checkout or CreateOrder Mutation.\n\n\n  var _useMutation = useMutation(CHECKOUT_MUTATION, {\n    variables: {\n      input: orderData\n    },\n    onCompleted: function onCompleted() {\n      console.warn('completed CHECKOUT_MUTATION');\n      refetch();\n    },\n    onError: function onError(error) {\n      if (error) {\n        setRequestError(error.graphQLErrors[0].message);\n      }\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      checkout = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      checkoutResponse = _useMutation2$.data,\n      checkoutLoading = _useMutation2$.loading,\n      checkoutError = _useMutation2$.error;\n  /*\n   * Handle form submit.\n   *\n   * @param {Object} event Event Object.\n   *\n   * @return {void}\n   */\n\n\n  var handleFormSubmit = function handleFormSubmit(event) {\n    event.preventDefault();\n    var result = validateAndSanitizeCheckoutForm(input);\n\n    if (!result.isValid) {\n      setInput(_objectSpread(_objectSpread({}, input), {}, {\n        errors: result.errors\n      }));\n      return;\n    }\n\n    var checkOutData = createCheckoutData(input);\n    setOrderData(checkOutData);\n    setRequestError(null);\n  };\n  /*\n   * Handle onchange input.\n   *\n   * @param {Object} event Event Object.\n   *\n   * @return {void}\n   */\n\n\n  var handleOnChange = function handleOnChange(event) {\n    if ('createAccount' === event.target.name) {\n      var newState = _objectSpread(_objectSpread({}, input), {}, _defineProperty({}, event.target.name, !input.createAccount));\n\n      setInput(newState);\n    } else {\n      var _newState = _objectSpread(_objectSpread({}, input), {}, _defineProperty({}, event.target.name, event.target.value));\n\n      setInput(_newState);\n    }\n  };\n\n  useEffect(function () {\n    if (null !== orderData) {\n      // Call the checkout mutation when the value for orderData changes/updates.\n      checkout();\n    }\n  }, [orderData]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [cart ? /*#__PURE__*/_jsx(\"form\", {\n      onSubmit: handleFormSubmit,\n      className: \"woo-next-checkout-form\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-20\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"billing-details\",\n          children: [/*#__PURE__*/_jsx(\"h2\", {\n            className: \"text-xl font-medium mb-4\",\n            children: \"Billing Details\"\n          }), /*#__PURE__*/_jsx(Billing, {\n            input: input,\n            handleOnChange: handleOnChange\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"your-orders\",\n          children: [/*#__PURE__*/_jsx(\"h2\", {\n            className: \"text-xl font-medium mb-4\",\n            children: \"Your Order\"\n          }), /*#__PURE__*/_jsx(YourOrder, {\n            cart: cart\n          }), /*#__PURE__*/_jsx(PaymentModes, {\n            input: input,\n            handleOnChange: handleOnChange\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"woo-next-place-order-btn-wrap mt-5\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              className: \"bg-purple-600 text-white px-5 py-3 rounded-sm w-auto xl:w-full\",\n              type: \"submit\",\n              children: \"Place Order\"\n            })\n          }), checkoutLoading && /*#__PURE__*/_jsx(\"p\", {\n            children: \"Processing Order...\"\n          }), requestError && /*#__PURE__*/_jsxs(\"p\", {\n            children: [\"Error : \", requestError, \" :( Please try again\"]\n          })]\n        })]\n      })\n    }) : '', /*#__PURE__*/_jsx(OrderSuccess, {\n      response: checkoutResponse\n    })]\n  });\n};\n\nexport default CheckoutForm;","map":null,"metadata":{},"sourceType":"module"}